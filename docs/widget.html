<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>IranianX Rate</title>
<style>
  body{font:15px/1.4 system-ui,Arial;margin:0;padding:12px;color:#1f2a39}
  .row{display:flex;justify-content:space-between;gap:16px;padding:8px 0;border-bottom:1px solid #eee}
  .pair{font-weight:600}
  .time{margin-top:8px;font-size:12px;opacity:.6}
</style>

<section id="list" aria-live="polite"></section>
<p class="time" id="time"></p>

<script>
async function load(){
  const res = await fetch("./rates.json", { cache: "no-store" });
  const d = await res.json();

  const L = document.getElementById("list");
  L.innerHTML = "";

  // ترتیب پیشنهادی؛ بقیه‌ی ارزها در ادامه به‌صورت خودکار می‌آیند
  const preferred = ["USD_TMN","USDT_TMN","EUR_TMN","GBP_TMN","TRY_TMN","JPY_TMN","CNY_TMN","GEL_TMN","AMD_TMN"];

  const keys = Object.keys(d.spot || {});
  const ordered = [
    ...preferred.filter(k => keys.includes(k)),
    ...keys.filter(k => !preferred.includes(k)).sort()
  ];

  for (const k of ordered){
    const v = d.spot[k];
    if (v == null) continue;
    const row = document.createElement("article");
    row.className = "row";
    row.setAttribute("role", "article");
    row.innerHTML = `<div class="pair">${k}</div><div>${Number(v).toLocaleString()}</div>`;
    L.appendChild(row);
  }

  const t = d.updated_at ? new Date(d.updated_at) : new Date();
  document.getElementById("time").textContent = "Updated: " + t.toLocaleString();
}
load();
setInterval(load, 60_000);
</script>
